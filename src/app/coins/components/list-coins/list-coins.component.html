<h1 class="text-4xl font-bold tracking-tight text-center mt-8 font-sans">
    Todas las criptomonedas
  </h1>
  <p class="mb-6 text-xl text-gray-600 dark:text-gray-800 text-center">
    Mira todas las criptomonedas del mercado y estudialas para sacarle el mayor rendimiento.
  </p>

  <div class="flex items-center justify-center">
    <input 
      type="text" 
      class="h-12 w-1/2 mb-8 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-200/40 p-4 text-gray-400" 
      placeholder="Busca tu criptomoneda favorita"
        [value]="q()"
        (input)="setQ($event.target.value)"
    >
    </div>
    <div class="flex items-center justify-center mb-4">
      <label class="mb-3 text-xl text-gray-600 dark:text-gray-800 text-center p-4">Ordenar por</label>
      <select
      class="border rounded-lg px-2 py-1"
      [value]="order()"
      (change)="setOrder($any($event.target).value)"
      >
      @for (o of orders; track o.value) {
        <option [value]="o.value">{{ o.label }}</option>
      }
    </select>
  </div>

@if (loading()) {
  <div class="space-y-3">
    <div class="h-16 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-200/40 animate-pulse"></div>
    <div class="h-16 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-200/40 animate-pulse"></div>
    <div class="h-16 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-200/40 animate-pulse"></div>
  </div>
} @else {

    <!-- CABECERA (sticky) -->
    <div
      class="sticky top-0 z-10 bg-white/90 dark:bg-gray-900/90 backdrop-blur
             grid gap-3 px-4 py-2 text-xs font-semibold text-gray-100
             [grid-template-columns:minmax(220px,2fr)_minmax(110px,1fr)_minmax(110px,1fr)_80px_80px_80px_minmax(140px,1fr)_minmax(140px,1fr)_170px]">
      <div>Moneda</div>
      <div>Ranking</div>
      <div>Precio</div>
      <div>1h</div>
      <div>24h</div>
      <div>7d</div>
      <div class="text-right">Market Cap</div>
      <div class="text-right">Volumen</div>
      <div class="text-right">Actualizado</div>
    </div>

    <!-- FILAS -->
    <div class="divide-y divide-gray-200 dark:divide-gray-700">
      @for (c of rows(); track c.id) {
        <a
          class="grid items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-200 transition
                 [grid-template-columns:minmax(220px,2fr)_minmax(110px,1fr)_minmax(110px,1fr)_80px_80px_80px_minmax(140px,1fr)_minmax(140px,1fr)_170px]"
          [routerLink]="['/menu', 'moneda', c.id]"
          [queryParams]="{vs: vsCurrency() }"
            aria-label="Ver detalle de {{c.name}}"
          [queryParamsHandling]="'preserve'"
        >
          <!-- Col 1: logo + nombre + símbolo -->
          <div class="flex items-center gap-3 min-w-0">
            <img [src]="c.image" [alt]="c.name" class="w-8 h-8 rounded-full" />
            <div class="min-w-0">
              <div class="font-medium truncate">
                {{ c.name }} ({{ c.symbol | uppercase }})
              </div>
            </div>
          </div>

          <div class="font-semibold">
            {{ c.market_cap_rank }}
          </div>
          <!-- Col 2: precio -->
          <div class="font-semibold">
            {{ c.current_price | currency:'USD':'symbol' }}
          </div>


          <!-- Col 3/4/5: chips -->
          <span [class]="chipClassStr(c.price_change_percentage_1h_in_currency)">
            {{ (c.price_change_percentage_1h_in_currency/100) | percent:'1.0-1' }}
          </span>
          <span [class]="chipClassStr(c.price_change_percentage_24h)">
            {{ (c.price_change_percentage_24h/100) | percent:'1.0-1' }}
          </span>
          <span [class]="chipClassStr(c.price_change_percentage_7d_in_currency)">
            {{ (c.price_change_percentage_7d_in_currency/100) | percent:'1.0-1' }}
          </span>

          <!-- Col 6: market cap -->
          <div class="text-right text-sm text-gray-800">
            ${{ abbr(c.market_cap) }}
          </div>

          <!-- Col 7: volumen -->
          <div class="text-right text-sm text-gray-800">
            ${{ abbr(c.total_volume) }}
          </div>

          <!-- Col 8: última actualización -->
          <time class="text-right text-sm text-gray-800"
                [attr.datetime]="c.last_updated"
                [title]="c.last_updated | date:'full'">
            {{ c.last_updated | date:'dd MMM yyyy · HH:mm' }}
          </time>
        </a>
      }
    </div>
    <div class="flex items-center justify-center">


      @if(!searchMode()) {

        <nav aria-label="Paginación" class="m-8 flex justify-center">
          <ul class="flex items-center -space-x-px h-10 text-base">
            
            <!-- Prev -->
            <li>
              <button type="button"
              (click)="prev()"
              [disabled]="page() === 1"
              class="flex items-center justify-center px-4 h-10 ms-0 leading-tight
              text-gray-500 bg-white border border-e-0 border-gray-300 rounded-s-lg
              hover:bg-gray-100 hover:text-gray-700
              dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400
              dark:hover:bg-gray-700 dark:hover:text-white
              disabled:opacity-50 disabled:pointer-events-none">
              <span class="sr-only">Anterior</span>
              <svg class="w-3 h-3 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
        </svg>
      </button>
    </li>
    
    @for (n of pages(); track n) {
      <li>
        @if (n === page()) {
          <!-- Activa -->
          <span aria-current="page"
          class="z-10 flex items-center justify-center px-4 h-10 leading-tight
          text-blue-600 border border-blue-300 bg-blue-50
          hover:bg-blue-100 hover:text-blue-700
          dark:border-gray-700 dark:bg-gray-700 dark:text-white">
          {{ n }}
        </span>
      } @else {
        <!-- Normal -->
        <button type="button"
        (click)="goTo(n)"
        class="flex items-center justify-center px-4 h-10 leading-tight
          text-gray-500 bg-white border border-gray-300
          hover:bg-gray-100 hover:text-gray-700
          dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400
          dark:hover:bg-gray-700 dark:hover:text-white">
          {{ n }}
        </button>
      }
    </li>
  }
  
  <!-- Next -->
  <li>
    <button type="button"
    (click)="next()"
    [disabled]="!canNext()"
    class="flex items-center justify-center px-4 h-10 leading-tight
    text-gray-500 bg-white border border-gray-300 rounded-e-lg
    hover:bg-gray-100 hover:text-gray-700
    dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400
    dark:hover:bg-gray-700 dark:hover:text-white
    disabled:opacity-50 disabled:pointer-events-none">
    <span class="sr-only">Siguiente</span>
    <svg class="w-3 h-3 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
        </svg>
      </button>
    </li>
    
  </ul>
</nav>
} @else {
  <p class="text-center my-6 text-sm opacity-70"> Resultados para "{{ q()}}" : {{ rows().length}} </p>
}
</div>

}
